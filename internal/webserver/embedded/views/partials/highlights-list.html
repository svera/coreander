{{$lang := .Lang}}
{{$session := .Session}}
{{$wordsPerMinute := .WordsPerMinute}}
{{$emailSendingConfigured := .EmailSendingConfigured}}
{{$emailFrom := .EmailFrom}}
{{$defaultAction := .DefaultAction}}
{{$canShare := .CanShare}}
{{$preferredEpub := .PreferredEpub}}

<div class="row mt-5 mb-2 d-flex">
    <div class="{{if and .ShowHighlightsFilter (eq .Results.TotalHits 0)}}col-12{{else}}col-6 col-md-8{{end}} align-content-end">
        {{if .ShowHighlightsFilter}}
            <div class="form-floating">
                <select class="form-select form-select-sm" id="highlights-filter" name="filter"
                        onchange="window.location.href='{{.FilterURL}}filter='+this.value;">
                    <option value="all" {{if or (eq .HighlightsFilter "") (eq .HighlightsFilter "all")}}selected{{end}}>{{t $lang "All documents (%d)" .HighlightsTotalAll}}</option>
                    <option value="highlights" {{if eq .HighlightsFilter "highlights"}}selected{{end}}>{{t $lang "Only my highlights"}}</option>
                    <option value="shared" {{if eq .HighlightsFilter "shared"}}selected{{end}}>{{t $lang "Only shared documents"}}</option>
                </select>
                <label for="highlights-filter">{{t $lang "Show"}}</label>
            </div>
        {{else if gt .Results.TotalHits 0}}
            <p class="text-start">{{t .Lang "%d documents found" .Results.TotalHits }}</p>
        {{end}}
    </div>
    <div class="col-6 col-md-4 text-end {{if and .ShowHighlightsFilter (eq .Results.TotalHits 0)}}d-none{{end}}">
        {{if ne .Results.TotalHits 0}}
            {{template "partials/sort" dict "SortURL" .SortURL "SortBy" .SortBy "Lang" $lang "AdditionalSortOptions" .AdditionalSortOptions}}
        {{end}}
    </div>
</div>
{{if eq .Results.TotalHits 0}}
<div class="row mt-5">
    <div class="col-12">
        <p class="text-center">{{t .Lang "No documents found" }}</p>
    </div>
</div>
{{end}}

{{if gt .Results.TotalHits 0}}
<ul class="list-group border-top rounded-0">
    {{range $i, $highlight := .Results.Hits}}
    <li class="list-group-item border border-0 px-0 mt-5">
        {{if and $highlight $highlight.SharedByID}}
            {{template "partials/highlights-list-shared-item" dict "Lang" $lang "Document" $highlight.Document "Session" $session "EmailSendingConfigured" $emailSendingConfigured "EmailFrom" $emailFrom "FQDN" $.fqdn "Version" $.Version "WordsPerMinute" $wordsPerMinute "Highlight" $highlight "DefaultAction" $defaultAction "CanShare" $canShare "PreferredEpub" $preferredEpub}}
        {{else}}
            {{template "partials/docs-list-item" dict "Lang" $lang "Document" $highlight.Document "Session" $session "FQDN" $.fqdn "Version" $.Version "WordsPerMinute" $wordsPerMinute "EmailSendingConfigured" $emailSendingConfigured "DefaultAction" $defaultAction "CanShare" $canShare "PreferredEpub" $preferredEpub}}
        {{end}}
    </li>
    {{end}}
</ul>
{{end}}

{{ $length := len .Paginator.Pages }} {{ if gt $length 1 }}
{{template "partials/pagination" .}}
{{end}}
