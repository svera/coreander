{{$lang := .Lang}}
{{$admins := .Admins}}
<div class="row mb-3 mt-5">
    <div class="col">
        <h2>{{t $lang "Users"}}</h2>
    </div>
    <div class="col text-end">
        <a href="/users/new" class="btn btn-primary">
            <i class="bi-person-plus-fill"></i>
            {{t $lang "Add user"}}
        </a>
    </div>
</div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>{{t $lang "Name"}}</th>
            <th colspan="2">{{t $lang "Last login"}}</th>
        </tr>
    </thead>
    <tbody>
    {{range $i, $user := .Users}}
        <tr>
            <td>
                <a href="/users/{{$user.Username}}">{{$user.Name}}</a>
                ({{$user.Email}})

                {{if eq $user.Role 2}}
                <span class="badge rounded-pill text-bg-secondary">Admin</span>
                {{end}}
            </td>
            <td>
                {{if $user.LastLogin.IsZero }}
                    {{t $lang "Never"}}
                {{else}}
                    {{$user.LastLogin.Format "2006-01-02 15:04"}}
                {{end}}
            </td>
            <td class="text-end">
                {{ if not (and (eq $admins 1) (eq $user.Role 2)) }}
                <a href="#" data-bs-toggle="modal" data-bs-target="#delete-modal" data-id="{{$user.Username}}">
                    <i class="bi-trash3-fill"></i>
                </a>
                {{end}}
            </td>
        </tr>
    {{end}}
    </tbody>
</table>

{{ $length := len .Paginator.Pages }} {{ if gt $length 1 }}
{{template "partials/pagination" .}}
{{end}}

{{template "partials/delete-modal" dict "Lang" $lang "Action" "users" "ModalHeader" "Delete user" "ModalBody" "Are you sure you want to delete this user?" "ModalErrorMessage" "There was an error deleting the user, try again later"}}

<script type="text/javascript" src="/js/delete.js"></script>
